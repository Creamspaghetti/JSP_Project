<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MyMapper">
	<!-- 전체 DB 조회후 productList.jsp에서 표시 -->
	<select id="getAllProducts" resultType="mydto">
		SELECT * FROM Products
	</select>

	<select id="getImage" resultType="mydto">
		SELECT IMAGE_URL FROM PRODUCTS
		p
		WHERE p.PRODUCT_ID = #{Image1}
	</select>

	<select id="getRefunds" resultType="mydto">
		SELECT
		p.PRODUCT_ID,
		p.Brand,
		p.Product_name,
		p.Price_amount,
		p.Image_url,
		o.ORDER_NUM,
		ord.ORDERED_NUM
		FROM
		Products p
		JOIN
		Order_ o ON p.PRODUCT_ID = o.PRODUCT_ID
		JOIN
		Ordered ord ON o.ORDER_NUM = ord.ORDER_NUM
		WHERE
		o.ORDER_NUM = #{thisorderNum}
	</select>

	<!-- 아직 DAO 랑 Action에 로직 추가 안했음 (유저 아이디도 가지고 올 수 있게 만들기)-->
	<select id="" resultType="mydto">
		SELECT o.ORDERED_NUM, o.ORDER_NUM, o.ordered_date
		FROM Ordered o
		JOIN Order_
		ord ON o.ORDER_NUM = ord.ORDER_NUM
		JOIN Cart c ON ord.PRODUCT_ID =
		c.PRODUCT_ID
		JOIN Users u ON c.USER_ID = u.USER_ID
		WHERE u.USER_ID = 'admin' AND o.ORDERED_NUM = #{thisorderNum}
	</select>

</mapper>
